Очень медленное решение получилось, разобраться как решать быстрее
